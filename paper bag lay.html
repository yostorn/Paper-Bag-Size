<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>คำนวณการใช้กระดาษสำหรับถุงกระดาษ (ปรับปรุงครั้งที่ 6)</title>
    <style>
        /* Existing styles remain the same */
        /* ... */
        select {
            margin: 10px 0;
            padding: 5px;
        }
    </style>
</head>
<body>
    <h1>คำนวณการใช้กระดาษสำหรับถุงกระดาษ (ปรับปรุงครั้งที่ 6)</h1>
    
    <!-- Existing bag size inputs remain the same -->
    <!-- ... -->

    <h2>ขนาดกระดาษ (ตัวเลือกที่ 1)</h2>
    <div>
        <label for="paperWidth1">ความกว้างกระดาษ:</label>
        <input type="number" id="paperWidth1" value="160" min="1" step="0.1">
        <select id="paperWidthUnit1">
            <option value="cm">ซม.</option>
            <option value="inch">นิ้ว</option>
        </select>
    </div>
    <div>
        <label for="paperHeight1">ความสูงกระดาษ:</label>
        <input type="number" id="paperHeight1" value="100" min="1" step="0.1">
        <select id="paperHeightUnit1">
            <option value="cm">ซม.</option>
            <option value="inch">นิ้ว</option>
        </select>
    </div>

    <h2>ขนาดกระดาษ (ตัวเลือกที่ 2)</h2>
    <div>
        <label for="paperWidth2">ความกว้างกระดาษ:</label>
        <input type="number" id="paperWidth2" value="170" min="1" step="0.1">
        <select id="paperWidthUnit2">
            <option value="cm">ซม.</option>
            <option value="inch">นิ้ว</option>
        </select>
    </div>
    <div>
        <label for="paperHeight2">ความสูงกระดาษ:</label>
        <input type="number" id="paperHeight2" value="100" min="1" step="0.1">
        <select id="paperHeightUnit2">
            <option value="cm">ซม.</option>
            <option value="inch">นิ้ว</option>
        </select>
    </div>

    <button onclick="calculate()">คำนวณ</button>

    <div id="result1" class="result"></div>
    <div id="result2" class="result"></div>

    <script>
        // Existing functions remain the same
        // ...

        function inchToCm(inch) {
            return inch * 2.54;
        }

        function getConvertedValue(value, unit) {
            return unit === 'inch' ? inchToCm(value) : value;
        }

        function calculate() {
            const D = parseFloat(document.getElementById('bagD').value);
            const W = parseFloat(document.getElementById('bagW').value);
            const H = parseFloat(document.getElementById('bagH').value);
            const P = parseFloat(document.getElementById('bagP').value);
            const { bagWidth, bagHeight } = calculateBagSize(D, W, H, P);

            const paperWidth1 = getConvertedValue(
                parseFloat(document.getElementById('paperWidth1').value),
                document.getElementById('paperWidthUnit1').value
            );
            const paperHeight1 = getConvertedValue(
                parseFloat(document.getElementById('paperHeight1').value),
                document.getElementById('paperHeightUnit1').value
            );
            const paperWidth2 = getConvertedValue(
                parseFloat(document.getElementById('paperWidth2').value),
                document.getElementById('paperWidthUnit2').value
            );
            const paperHeight2 = getConvertedValue(
                parseFloat(document.getElementById('paperHeight2').value),
                document.getElementById('paperHeightUnit2').value
            );

            const result1 = calculateOptimalLayout(paperWidth1, paperHeight1, bagWidth, bagHeight);
            const result2 = calculateOptimalLayout(paperWidth2, paperHeight2, bagWidth, bagHeight);

            document.getElementById('result1').innerHTML = generateResult(result1, paperWidth1, paperHeight1, bagWidth, bagHeight, D, W, H, P, 'layoutCanvas1');
            document.getElementById('result2').innerHTML = generateResult(result2, paperWidth2, paperHeight2, bagWidth, bagHeight, D, W, H, P, 'layoutCanvas2');

            drawLayout('layoutCanvas1', paperWidth1, paperHeight1, bagWidth, bagHeight, result1);
            drawLayout('layoutCanvas2', paperWidth2, paperHeight2, bagWidth, bagHeight, result2);
        }

        function generateResult(result, paperWidth, paperHeight, bagWidth, bagHeight, D, W, H, P, canvasId) {
            let resultHTML = `<h2>ผลลัพธ์ (กระดาษขนาด ${paperWidth.toFixed(2)} x ${paperHeight.toFixed(2)} ซม.)</h2>`;
            resultHTML += `<p>ขนาดกระดาษ: ${paperWidth.toFixed(2)} x ${paperHeight.toFixed(2)} ซม.</p>`;
            // Rest of the function remains the same
            // ...
            return resultHTML;
        }
    </script>
</body>
</html>
